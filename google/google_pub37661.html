<!DOCTYPE html>
<html class="google" lang="en">
  <head>

    <script>
    (function(H){H.className=H.className.replace(/\bgoogle\b/,'google-js')})(document.documentElement)
    </script>
    <meta charset="utf-8">
    <meta content="initial-scale=1, minimum-scale=1, width=device-width" name="viewport">
    <title>
      Rootkits in your web application
    </title>
    <script src="//www.google.com/js/google.js">
    </script>
    <script>
    new gweb.analytics.AutoTrack({profile:"UA-5974346-1"});
    </script>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;lang=en" rel=
    "stylesheet">
    <link href="/css/research.css" rel="stylesheet">
    <style>
    object.c1 {height: 390px; width: 640px}
    </style>
  </head>
  <body>
    <div class="maia-header" id="maia-header" role="banner">
      <div class="maia-aux">
        <h1>
          <a href="/" id="logo"><img alt="Research at Google" src=
          "/images/research_at_google.png"></a>
        </h1><a class="maia-teleport" href="#content">Skip to content</a>
        <div class="maia-util">
          <form class="maia-search" id="search" name="search">
            <input id="q" name="q" placeholder="Search this site" value=""> <input class=
            "maia-button" type="submit" value="Search">
          </form>
        </div>
      </div>
    </div>
    <div class="maia-nav maia-complex" id="maia-nav-x" role="navigation">
      <div class="maia-aux">
        <ul>
          <li>
            <a href="/index.html">Home</a>
          </li>
          <li class="active" id="ra">
            <a href="/pubs/papers.html">Research Areas &amp; Publications</a> <span class=
            "glyph">&nbsp;</span>
            <div class="hidden">
              <ul id="ramenu">
                <li class="fill">
                  <a href="/pubs/papers.html">Overview</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/AlgorithmsandTheory.html">Algorithms and Theory</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/DataManagement.html">Data Management</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/DataMiningandModeling.html">Data Mining and Modeling</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/DistributedSystemsandParallelComputing.html">Distributed Systems
                  and Parallel Computing</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/EconomicsandElectronicCommerce.html">Economics and Electronic
                  Commerce</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/EducationInnovation.html">Education Innovation</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/GeneralScience.html">General Science</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/HardwareandArchitecture.html">Hardware and Architecture</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/Human-ComputerInteractionandVisualization.html">Human-Computer
                  Interaction and Visualization</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/InformationRetrievalandtheWeb.html">Information Retrieval and the
                  Web</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/MachineIntelligence.html">Machine Intelligence</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/MachinePerception.html">Machine Perception</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/MachineTranslation.html">Machine Translation</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/MobileSystems.html">Mobile Systems</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/NaturalLanguageProcessing.html">Natural Language Processing</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/Networking.html">Networking</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/SecurityPrivacyandAbusePrevention.html">Security, Privacy and
                  Abuse Prevention</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/SoftwareEngineering.html">Software Engineering</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/SoftwareSystems.html">Software Systems</a>
                </li>
                <li class="expand fill">
                  <a href="/pubs/SpeechProcessing.html">Speech Processing</a>
                </li>
              </ul>
            </div>
          </li>
          <li>
            <a href="/researchers.html">People</a>
          </li>
          <li>
            <a href="/university/">Research Programs</a>
          </li>
          <li>
            <a href="/workatgoogle.html">Work at Google</a>
          </li>
        </ul>
      </div>
    </div>
    <div id="maia-main" role="main">
      <div class="maia-teleport" id="content"></div>
      <div id="cse">
        &nbsp;
      </div>
      <h1>
        Publication Data
      </h1>
      <div class="maia-cols">
        <div class="maia-col-4">
          <div>
            <div class="sidebar">
              <h3>
                Venue
              </h3>
              <p>
                <span class="booktitle">28C3: Chaos Communications Congress</span>, Berlin, Germany
                <span class="year">(2011)</span>
              </p>
              <h3>
                Publication Year
              </h3>
              <p>
                2011
              </p>
              <h3>
                Authors
              </h3>
              <p>
                Artur Janc
              </p>
              <h3>
                BibTeX
              </h3>
              <textarea cols="38" rows="15">
@inproceedings{37661,
title = {Rootkits in your web application},
author  = {Artur Janc},
year  = 2011,
booktitle = {28C3: Chaos Communications Congress},
address = {Berlin, Germany}
}

</textarea>
            </div>
          </div>
        </div>
        <div class="maia-col-8">
          <h2 class="abstract-heading">
            <a class="search-icon tooltip" href=
            "http://www.google.com/search?lr&amp;ie=UTF-8&amp;oe=UTF-8&amp;q=Rootkits+in+your+web+application+Janc">
            &nbsp;</a> Rootkits in your web application
          </h2>
          <div>
            <strong>Abstract:</strong> In this work, I discuss practical approaches for exploiting
            cross-site scripting (XSS) and other client-side script injection vulnerabilities, and
            introduce novel techniques for maintaining and escalating access within the victim's
            browser. In particular, I introduce the concept of resident XSS where attacker-supplied
            code is running in the context of an affected user's main application window and
            describe its consequences. I also draw analogies between such persistent Web threats
            and traditional rootkits, including similarities in the areas of embedding malicious
            code, maintaining access, and the difficulty of detecting and removing
            attacker-supplied code.
            <p>
              <strong>Details</strong>
            </p>
            <p>
              Despite a few high profile cases of XSS worms, the exploitation of script injection
              vulnerabilities has historically been mostly limited to cookie-stealing and executing
              simple malicious actions in the context of the affected Web application. However, as
              a consequence of inter-document interactions allowed by the same-origin policy and a
              combination of other browser mechanisms, a single XSS vulnerability can often lead to
              a long-term compromise all of a user's interactions with an affected webapp in the
              same browser profile, long after the original bug has been fixed. In particular, an
              attacker can maintain access across window/browser closures, survive cookie and cache
              deletions, and compromise other user accounts accessed from the same browser. Yet
              more troubling is the fact that Web application authors currently have no means to
              detect or mitigate such threats once an attack has taken place.
            </p>
            <p>
              In the talk I provide an overview of script injection attacks against Web clients,
              describe techniques to escalate an XSS into long-term account compromise, and
              introduce the concept of resident XSS where attacker-supplied code is injected into
              the user's main application window. Additionally, I explore the similarities between
              such Web bugs and traditional rootkits. In particular, I:
            </p>
            <ol>
              <li>Provide an overview of script injection vulnerabilities and describe real-world
              considerations for exploiting them against modern Web applications.
              </li>
              <li>Introduce the concept of resident XSS, where malicious JavaScript is executed in
              the context of the victim's main application window/tab. Contrary to the traditional
              methods of exploiting XSS via a hidden frame or malicious link which are opened in a
              separate, usually short-lived window, resident XSS gives an attacker full freedom to
              monitor and alter the user's interaction with the affected application.
              </li>
              <li>Describe several techniques to convert various Web bugs into a resident XSS. Such
              techniques include backdooring client-side persistent storage mechanisms (WebSQL,
              localStorage, Flash LSOs), opening poisoned application windows with injected
              malicious scripts, exploiting persistent (self-)XSS and others.
              </li>
              <li>Discuss the consequences of resident XSS, which usually allow the attacker to get
              permanent access to an affected user's account and/or obtain the user's application
              login credentials. On sensitive domains for which users have enabled access to
              additional browser or plugin features (geolocation, camera/microphone), it can enable
              persistent snooping on the exploited user. In a large number of cases it can also
              enable full compromise of the user's machine by exploiting the application-user trust
              relationship (e.g. by requiring the user to install attacker-supplied plugins to use
              the affected webapp, or by hijacking file download links within the vulnerable
              domain).
              </li>
              <li>Analyze the techniques for maintaining access to a once-compromised origin. In
              addition to backdooring persistent storage APIs, this can be achieved by exploiting
              self-XSS bugs, spawning same-origin pop-unders with references to the original
              window, and hiding in frames created by advertising networks on popular websites. In
              most cases, a combination of those techniques suffices to bypass a variety of the
              most common "cleanup" actions taken by users, and allows an on-going compromise of
              the affected origin.
              </li>
              <li>Present the difficulties faced by Web application authors when trying to clean up
              a compromised origin. Short of wiping/re-creating a browser profile, there are
              currently no fully reliable methods to restore a browser's state to a secure
              configuration once a malicious script has run in the context of an affected domain.
              </li>
            </ol>
            <p>
              A video of the presentation is below.
            </p>
            <p>
              <object class="c1">
                <param name="movie" value=
                "http://www.youtube.com/v/ppFcSP2HWdE?version=3&amp;feature=player_detailpage">
                <param name="allowFullScreen" value="true">
                <param name="allowScriptAccess" value="always">
                <embed allowfullscreen="true" allowscriptaccess="always" height="360" src=
                "http://www.youtube.com/v/ppFcSP2HWdE?version=3&amp;feature=player_detailpage"
                type="application/x-shockwave-flash" width="640">
              </object>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div id="maia-signature"></div>
    <div class="maia-footer" id="maia-footer">
      <div id="maia-footer-local">
        <div class="maia-aux">
          <ul class="expand no-marker" id="footer-local">
            <li>
              <a class="googleplus middle" href=
              "//plus.google.com/117790530324740296539/posts">Google Plus</a>
              <p>
                Thoughts from Google's academic community
              </p>
            </li>
            <li>
              <a class="twitter middle" href="//twitter.com/googleresearch">Twitter</a>
              <p>
                Research at Google announcements
              </p>
            </li>
            <li>
              <a class="blogger middle" href="//googleresearch.blogspot.com/">Research Blog</a>
              <p>
                The latest news from Research at Google
              </p>
            </li>
            <li>
              <a class="scholar middle" href="//scholar.google.com/">Google Scholar</a>
              <p>
                Search for scholarly literature
              </p>
            </li>
            <li>
              <a class="youtube middle" href=
              "//www.youtube.com/user/GoogleTechTalks/featured">YouTube Tech Talks</a>
              <p>
                Tech talks by leaders in the field
              </p>
            </li>
          </ul>
        </div>
      </div>
      <div id="maia-footer-global">
        <div class="maia-aux">
          <ul>
            <li>
              <a href="//www.google.com/">Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/about/">About Google</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/privacy/">Privacy</a>
            </li>
            <li>
              <a href="//www.google.com/intl/en/policies/terms/">Terms</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <script src="//www.google.com/jsapi">
    </script> 
    <script src="/js/research.view.js">
    </script> 
    <script src="//www.google.com/js/maia.js">
    </script>
  </body>
</html>